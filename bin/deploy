#!/usr/bin/env bash
set -e

export DAPP_NO_SAVE=1
export ETH_GAS=4000000
export ETH_KEYSTORE=/home/aftnix/.dapp/testnet/8545/keystore/
export FOUNDERS_KEY=0x40298bEf6D91762787479c5F2CA162627bB8d528
token=0x1125d7564f4b0919020d7fb61b4bf13637c4ea7c

sale=$(set -x; dapp create EkkDist 7 \
   $(seth --to-uint256 $(seth --to-wei 1000000000 eth)) \
   $(date +%s -d '1 second') \
   $(date +%s -d '1 hour') \
   $(seth --to-uint256 $(seth --to-wei 100000000 eth)) \
   $FOUNDERS_KEY
 )

 (set -x; seth send "$token" "setOwner(address)" "$sale")
 (set -x; seth send "$sale" "initialize(address)" "$token")

echo "token=$token"
echo "sale=$sale"
